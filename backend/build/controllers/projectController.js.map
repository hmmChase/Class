{"version":3,"sources":["../../src/controllers/projectController.js"],"names":["PrismaClient","pkg","prisma","getAllProjects","req","res","next","project","findMany","orderBy","id","include","author","projectRecords","json","getChallengeProjects","challengePath","params","where","challenge","path","deletedAt","projects","create","body","githubLink","additionalLink","comments","user","jwt","verify","cookies","Buffer","from","process","env","ACCESS_TOKEN_SECRET","data","connect","projectRecord"],"mappings":";;;;;;;;;;;;;AACA;;AAEA;;AAHA;AAEA,IAAQA,YAAR,GAAyBC,kBAAzB,CAAQD,YAAR;AAGA,IAAME,MAAM,GAAG,IAAIF,YAAJ,EAAf;AAEA;;AAEO,IAAMG,cAAc;AAAA,2FAAG,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACCJ,MAAM,CAACK,OAAP,CAAeC,QAAf,CAAwB;AACnDC,cAAAA,OAAO,EAAE;AAAEC,gBAAAA,EAAE,EAAE;AAAN,eAD0C;AAEnDC,cAAAA,OAAO,EAAE;AAAEC,gBAAAA,MAAM,EAAE;AAAV;AAF0C,aAAxB,CADD;;AAAA;AACtBC,YAAAA,cADsB;AAAA,6CAMrBR,GAAG,CAACS,IAAJ,CAASD,cAAT,CANqB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAdV,cAAc;AAAA;AAAA;AAAA,GAApB;;;;AASA,IAAMY,oBAAoB;AAAA,4FAAG,kBAAOX,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAC1BU,YAAAA,aAD0B,GACRZ,GAAG,CAACa,MADI,CAC1BD,aAD0B;AAAA;AAAA,mBAGXd,MAAM,CAACK,OAAP,CAAeC,QAAf,CAAwB;AAC7CU,cAAAA,KAAK,EAAE;AAAEC,gBAAAA,SAAS,EAAE;AAAEC,kBAAAA,IAAI,EAAEJ;AAAR,iBAAb;AAAsCK,gBAAAA,SAAS,EAAE;AAAjD,eADsC;AAE7CV,cAAAA,OAAO,EAAE;AAAEC,gBAAAA,MAAM,EAAE;AAAV,eAFoC;AAG7CH,cAAAA,OAAO,EAAE;AAAEC,gBAAAA,EAAE,EAAE;AAAN;AAHoC,aAAxB,CAHW;;AAAA;AAG5BY,YAAAA,QAH4B;AAAA,8CAS3BjB,GAAG,CAACS,IAAJ,CAASQ,QAAT,CAT2B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAApBP,oBAAoB;AAAA;AAAA;AAAA,GAA1B;AAYP;;;;;AAEO,IAAMQ,MAAM;AAAA,4FAAG,kBAAOnB,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,wBAC6BF,GAAG,CAACoB,IADjC,EACZC,UADY,aACZA,UADY,EACAC,cADA,aACAA,cADA,EACgBC,QADhB,aACgBA,QADhB;AAGdC,YAAAA,IAHc,GAGPC,yBAAIC,MAAJ,CACX1B,GAAG,CAAC2B,OAAJ,CAAYF,GADD,EAEXG,MAAM,CAACC,IAAP,CAAYC,OAAO,CAACC,GAAR,CAAYC,mBAAxB,EAA6C,QAA7C,CAFW,CAHO;AAAA;AAAA,mBAQQlC,MAAM,CAACK,OAAP,CAAegB,MAAf,CAAsB;AAChDc,cAAAA,IAAI,EAAE;AACJZ,gBAAAA,UAAU,EAAVA,UADI;AAEJC,gBAAAA,cAAc,EAAdA,cAFI;AAGJC,gBAAAA,QAAQ,EAARA,QAHI;AAIJf,gBAAAA,MAAM,EAAE;AAAE0B,kBAAAA,OAAO,EAAE;AAAE5B,oBAAAA,EAAE,EAAEkB,IAAI,CAACA,IAAL,CAAUlB;AAAhB;AAAX;AAJJ;AAD0C,aAAtB,CARR;;AAAA;AAQd6B,YAAAA,aARc;AAAA,8CAiBblC,GAAG,CAACS,IAAJ,CAASyB,aAAT,CAjBa;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAANhB,MAAM;AAAA;AAAA;AAAA,GAAZ","sourcesContent":["// import { PrismaClient } from '@prisma/client';\r\nimport pkg from '@prisma/client';\r\nconst { PrismaClient } = pkg;\r\nimport jwt from 'jsonwebtoken';\r\n\r\nconst prisma = new PrismaClient();\r\n\r\n/* GET */\r\n\r\nexport const getAllProjects = async (req, res, next) => {\r\n  const projectRecords = await prisma.project.findMany({\r\n    orderBy: { id: 'desc' },\r\n    include: { author: true }\r\n  });\r\n\r\n  return res.json(projectRecords);\r\n};\r\n\r\nexport const getChallengeProjects = async (req, res, next) => {\r\n  const { challengePath } = req.params;\r\n\r\n  const projects = await prisma.project.findMany({\r\n    where: { challenge: { path: challengePath }, deletedAt: null },\r\n    include: { author: true },\r\n    orderBy: { id: 'desc' }\r\n  });\r\n\r\n  return res.json(projects);\r\n};\r\n\r\n/* POST */\r\n\r\nexport const create = async (req, res, next) => {\r\n  const { githubLink, additionalLink, comments } = req.body;\r\n\r\n  const user = jwt.verify(\r\n    req.cookies.jwt,\r\n    Buffer.from(process.env.ACCESS_TOKEN_SECRET, 'base64')\r\n  );\r\n\r\n  const projectRecord = await prisma.project.create({\r\n    data: {\r\n      githubLink,\r\n      additionalLink,\r\n      comments,\r\n      author: { connect: { id: user.user.id } }\r\n    }\r\n  });\r\n\r\n  return res.json(projectRecord);\r\n};\r\n"],"file":"projectController.js"}